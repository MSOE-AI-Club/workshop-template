<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='edit' hidden></marimo-mode>
    <marimo-version data-version='0.13.2' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"code_editor_font_size": 14, "dataframes": "rich", "default_table_page_size": 10, "theme": "light", "default_width": "medium", "cell_output": "above"}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "reactive_tests": true, "on_cell_change": "autorun", "watcher_on_save": "lazy", "output_max_bytes": 8000000, "std_stream_max_bytes": 1000000}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "language_servers": {"pylsp": {"enabled": true, "enable_mypy": true, "enable_ruff": true, "enable_flake8": false, "enable_pydocstyle": false, "enable_pylint": false, "enable_pyflakes": false}}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "compact", "app_title": "MSOE AI Club - Webscraping", "sql_output": "auto"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>MSOE AI Club - Webscraping</title>
    <script type="module" crossorigin src="./assets/index-CBYlZPe-.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-DQ-mLFwY.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.13.2%22%0Aapp%20%3D%20marimo.App(app_title%3D%22MSOE%20AI%20Club%20-%20Webscraping%22)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20Webscraping%0A%20%20%20%20%20%20%20%20%3D%3D%3D%0A%20%20%20%20%20%20%20%20MAIC%20-%20Spring%2C%20Week%203%3Cbr%3E%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20%20%20_____________%0A%20%20%20%20%20%20%20%20%20%2F0%20%20%20%2F%20%20%20%20%20%5C%20%20%5C%0A%20%20%20%20%20%20%20%20%2F%20%20%5C%20M%20A%20I%20C%2F%20%20%2F%5C%0A%20%20%20%20%20%20%20%20%5C%20%2F%20*%20%20%20%20%20%20%2F%20%20%2F%20%2F%0A%20%20%20%20%20%20%20%20%20%5C___%5C____%2F%20%20%40%20%2F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C_%2F_%2F%0A%20%20%20%20%20%20%20%20%60%60%60%0A%20%20%20%20%20%20%20%20(Rosie%20is%20not%20needed!)%0A%0A%20%20%20%20%20%20%20%20Prereqs%3A%0A%20%20%20%20%20%20%20%20-%20Install%20%5BVSCode%5D(https%3A%2F%2Fcode.visualstudio.com%2F)%0A%20%20%20%20%20%20%20%20-%20Install%20%5BPython%5D(https%3A%2F%2Fwww.python.org%2Fdownloads%2F)%0A%20%20%20%20%20%20%20%20%20%20-%20%22The%20best%20language%22%20-%20Guido%20van%20Rossum%0A%20%20%20%20%20%20%20%20-%20Ensure%20you%20can%20run%20notebooks%20in%20VSCode.%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%23ff5555%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20STOP%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20...%20or%20keep%20going%20if%20you%20want%20to%20work%20ahead.%0A%0A%20%20%20%20%20%20%20%20---%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20**What%20is%20webscraping%3F**%0A%0A%20%20%20%20%20%20%20%20Are%20you%20in%20need%20of%20data%3F%20Maybe%20you%20want%20to%20analyze%20some%20data%20for%20insights.%20Or%20maybe%20you%20just%20want%20to%20train%20a%20model.%20In%20any%20case%2C%20you%20may%20be%20able%20to%20get%20the%20data%20you%20need%20via%20webscraping!%0A%0A%20%20%20%20%20%20%20%20Webscraping%20is%20the%20process%20of%20*automatically*%20extracting%20data%20from%20websites.%20You%20can%20manually%20extract%20website%20data%20on%20your%20browser%20via%20%22inspect%2C%22%20but%20automating%20this%20process%20is%20ideal%20if%20you%20need%20anything%20more%20than%20a%20few%20samples.%0A%0A%20%20%20%20%20%20%20%20-%20Go%20to%20any%20website%20(for%20instance%2C%20the%20%5BMAIC%5D(https%3A%2F%2Fmsoe-maic.com%2F)%20site).%0A%20%20%20%20%20%20%20%20-%20Right-click%20anywhere%20on%20the%20page.%20Select%20the%20%22inspect%22%20option%20or%20something%20labeled%20similarly.%20This%20is%20usually%20at%20the%20bottom%20of%20the%20pop-up%20menu.%0A%20%20%20%20%20%20%20%20-%20Note%20the%20window%20that%20opened.%20It%20contains%20the%20raw%20HTML%20(and%20possibly%20JS%2FCSS)%20site%20data.%20This%20is%20what%20we%20want%20to%20scrape%20automatically.%0A%20%20%20%20%20%20%20%20-%20Use%20the%20element%20selector%20at%20the%20top%20left%20of%20the%20inspect%20window%20to%20see%20the%20HTML%20of%20specific%20elements.%0A%0A%20%20%20%20%20%20%20%20---%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%2355ff55%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20GO%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20**That's%20cool.%20How%20can%20I%20scrape%20automatically%3F**%0A%0A%20%20%20%20%20%20%20%20Let's%20try%20scraping%20the%20MAIC%20leaderboard!%0A%0A%20%20%20%20%20%20%20%20Basic%20scraping%20only%20needs%20the%20%60requests%60%20library.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20requests%0A%0A%20%20%20%20URL%20%3D%20'https%3A%2F%2Fmsoe-maic.com'%0A%0A%20%20%20%20html%20%3D%20requests.get(URL).text%20%23%20Make%20a%20request%20to%20the%20URL%20and%20get%20the%20HTML%20via%20%60.text%60%0A%20%20%20%20print(html%5B%3A500%5D)%20%23%20Print%20some%20of%20the%20resulting%20HTML%0A%20%20%20%20return%20html%2C%20requests%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20This%20html%20now%20contains%20the%20leaderboard%20for%20us%20to%20extract.%20But%20how%20do%20we%20extract%20it%3F%0A%0A%20%20%20%20%20%20%20%20One%20easy%20way%20is%20to%20*inspect*%20the%20page%20on%20your%20browser%2C%20and%20to%20see%20if%20the%20HTML%20can%20easily%20identify%20the%20leaderboard.%20It%20seems%20that%20the%20leaderboard%20element%20is%20in%20the%20%22leaderboard-table%22%20class%3A%0A%0A%20%20%20%20%20%20%20%20%60%60%60html%0A%20%20%20%20%20%20%20%20%3Ctable%20border%3D%221%22%20class%3D%22dataframe%20leaderboard-table%22%20id%3D%22df_data%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%20%20%20%20%20%20%20%20%3C%2Ftable%3E%0A%20%20%20%20%20%20%20%20%60%60%60%0A%0A%20%20%20%20%20%20%20%20We%20could%20try%20looking%20for%20%22leaderboad-table%22%20in%20the%20html%20string%2C%20but%20there's%20a%20better%20way.%20%60Beautifulsoup%60%20is%20a%20Python%20library%20that%20makes%20parsing%20HTML%20easy.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0Aapp._unparsable_cell(%0A%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20Install%20BeautifulSoup%20and%20possibly%20restart%20your%20notebook%2C%20being%20sure%20to%20re-run%20prior%20cells.%0A%20%20%20%20%25pip%20install%20beautifulsoup4%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20name%3D%22_%22%0A)%0A%0A%0A%40app.cell%0Adef%20_(html)%3A%0A%20%20%20%20from%20bs4%20import%20BeautifulSoup%20%23%20We%20can%20now%20use%20BeautifulSoup%20to%20parse%20the%20HTML%0A%0A%20%20%20%20soup%20%3D%20BeautifulSoup(html%2C%20'html.parser')%20%0A%20%20%20%20print(soup.prettify()%5B%3A500%5D)%20%23%20print%20it%20as%20before%2C%20but%20now%20it's%20prettified%0A%20%20%20%20return%20(soup%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Now%20we%20can%20use%20BeautifulSoup%20to%20find%20the%20%22leaderboard-table%22%20element.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(soup)%3A%0A%20%20%20%20%23%20find%20the%20table%20element%20with%20class%20%22leaderboard-table%22%0A%0A%20%20%20%20leaderboard_table%20%3D%20soup.find('table'%2C%20%7B'class'%3A%20'leaderboard-table'%7D)%0A%0A%20%20%20%20print(leaderboard_table.prettify()%5B%3A500%5D)%20%23%20print%20the%20first%20500%20characters%20of%20the%20table%0A%20%20%20%20return%20(leaderboard_table%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Not%20only%20can%20Beautifulsoup%20find%20the%20element%2C%20it%20also%20allows%20us%20to%20easily%20extract%20the%20data.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(leaderboard_table)%3A%0A%20%20%20%20%23%20Extract%20table%20data%20into%20a%20list%20of%20dictionaries%0A%0A%20%20%20%20rows%20%3D%20leaderboard_table.find_all('tr')%20%23%20Find%20all%20rows%20in%20the%20table%0A%20%20%20%20header%20%3D%20%5Bcell.text%20for%20cell%20in%20rows%5B0%5D.find_all('th')%5D%20%23%20Get%20the%20header%20row%0A%20%20%20%20data%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%7Bheader%5Bi%5D%3A%20cell.text%20for%20i%2C%20cell%20in%20enumerate(row.find_all('td'))%7D%20%23%20Create%20a%20dictionary%20for%20each%20row%20using%20the%20header%20to%20name%20the%20keys%0A%20%20%20%20%20%20%20%20for%20row%20in%20rows%5B1%3A%5D%0A%20%20%20%20%5D%0A%0A%20%20%20%20data%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20Pretty%20neat%2C%20right%3F%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%23ff5555%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20STOP%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20...%20or%20keep%20going%20if%20you%20want%20to%20work%20ahead.%0A%0A%20%20%20%20%20%20%20%20---%0A%0A%20%20%20%20%20%20%20%20**It's%20not%20always%20this%20easy.**%0A%0A%20%20%20%20%20%20%20%20Some%20pages%20dynamically%20generate%20content%20using%20Javascript.%20This%20is%20a%20problem%20for%20us%20because%20the%20%60requests%60%20library%20cannot%20run%20Javascript%20code.%20Let's%20try%20to%20scrape%20content%20from%20a%20page%20that%20uses%20a%20lot%20of%20Javascript.%0A%0A%20%20%20%20%20%20%20%20-%20Go%20to%20%5Bthe%20MAIC%20research%20groups%20page%5D(https%3A%2F%2Fmsoe-maic.com%2Flibrary%3Fnav%3DResearch).%0A%20%20%20%20%20%20%20%20-%20Use%20the%20element%20selector%20to%20select%20a%20group's%20section.%0A%20%20%20%20%20%20%20%20-%20Note%20the%20id%20of%20the%20element.%0A%0A%20%20%20%20%20%20%20%20For%20instance%2C%20the%20page%20has%20this%20div%20with%20an%20id%20of%20%60agent-simulation-experts%60.%0A%0A%20%20%20%20%20%20%20%20%60%60%60html%0A%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22MuiPaper-root%20MuiPaper-elevation%20MuiPaper-rounded%20MuiPaper-elevation1%20MuiCard-root%20modal%20css-1kil0ip%22%20id%3D%22agent-simulation-experts%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%60%60%60%0A%0A%20%20%20%20%20%20%20%20It's%20important%20to%20note%2C%20however%2C%20that%20this%20element%20was%20generated%20with%20Javascript.%20So%20what%20happens%20if%20we%20try%20scraping%20this%20element%20with%20%60requests%60%3F%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%2355ff55%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20GO%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(requests)%3A%0A%20%20%20%20URL_1%20%3D%20'https%3A%2F%2Fmsoe-maic.com%2Flibrary%3Fnav%3DResearch'%0A%20%20%20%20html_1%20%3D%20requests.get(URL_1).text%0A%20%20%20%20print(html_1)%0A%20%20%20%20return%20(html_1%2C)%0A%0A%0A%40app.cell%0Adef%20_(html_1)%3A%0A%20%20%20%20print('agent-simulation-experts'%20in%20html_1)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%235555ff%3Bfont-weight%3Abold%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20Try%20this%20yourself.%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20Go%20to%20some%20websites%20and%20see%20what%20HTML%20you%20can%20scrape%20with%20%60requests%60.%20See%20if%20anything%20in%20the%20browser%20inspection%20tool%20appears%20in%20the%20%60html%60%20variable.%20You%20may%20find%20that%20a%20majority%20of%20websites%20aren't%20easily%20scrapable.%0A%0A%20%20%20%20%20%20%20%20Some%20sites%20to%20try%3A%0A%20%20%20%20%20%20%20%20-%20https%3A%2F%2Fwww.youtube.com%2F%0A%20%20%20%20%20%20%20%20-%20https%3A%2F%2Fwww.google.com%2Fsearch%3Fq%3Dyour%2Bsearch%2Bhere%0A%20%20%20%20%20%20%20%20-%20https%3A%2F%2Fwww.reddit.com%2F%0A%20%20%20%20%20%20%20%20-%20https%3A%2F%2Fstackoverflow.com%2Fquestions%0A%20%20%20%20%20%20%20%20-%20https%3A%2F%2Fgithub.com%2Ftorvalds%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%23ff5555%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20STOP%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20...%20or%20keep%20going%20if%20you%20want%20to%20work%20ahead.%0A%0A%20%20%20%20%20%20%20%20---%0A%0A%20%20%20%20%20%20%20%20**Q%3A%20So%20how%20do%20we%20scrape%20pages%20that%20use%20Javascript%3F**%0A%0A%20%20%20%20%20%20%20%20A%3A%20Use%20Selenium.%0A%0A%20%20%20%20%20%20%20%20Selenium%20is%20a%20headless%20browser%20that%20can%20execute%20page%20Javascript.%0A%0A%20%20%20%20%20%20%20%20the%20%60requests%60%20library%20cannot%20run%20Javascript%2C%20so%20any%20page%20content%20generated%20by%20said%20Javascript%20is%20impossible%20to%20scrape%20with%20%60requests%60%20alone.%20Luckily%2C%20browsers%20are%20*made*%20to%20run%20Javascript.%20Selinum%20runs%20javascript%20like%20a%20regular%20browser%20(and%20it%20even%20uses%20a%20regular%20browser%20such%20as%20Chrome%20under%20the%20hood)%2C%20but%20it%20functions%20without%20a%20UI%20so%20you%20can%20interact%20with%20pages%20programatically%0A%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%2355ff55%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20GO%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20We'll%20wrap%20%60selenium%60%20in%20a%20function%20call%20to%20make%20it%20work%20similarly%20to%20%60requests%60.%20Feel%20free%20to%20read%20the%20function%20comments%20if%20you%20want%20to%20dive%20deeper%20into%20%60selenium%60.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(BeautifulSoup_1)%3A%0A%20%20%20%20from%20selenium%20import%20webdriver%0A%20%20%20%20from%20selenium.webdriver.chrome.service%20import%20Service%20as%20ChromeService%0A%20%20%20%20from%20selenium.webdriver.edge.service%20import%20Service%20as%20EdgeService%0A%20%20%20%20from%20selenium.webdriver.chrome.options%20import%20Options%20as%20ChromeOptions%0A%20%20%20%20from%20selenium.webdriver.edge.options%20import%20Options%20as%20EdgeOptions%0A%20%20%20%20from%20webdriver_manager.chrome%20import%20ChromeDriverManager%0A%20%20%20%20from%20webdriver_manager.microsoft%20import%20EdgeChromiumDriverManager%0A%20%20%20%20from%20bs4%20import%20BeautifulSoup%0A%20%20%20%20import%20time%0A%0A%20%20%20%20def%20setup_chrome()%3A%0A%20%20%20%20%20%20%20%20options%20%3D%20ChromeOptions()%0A%20%20%20%20%20%20%20%20options.add_argument('--headless')%0A%20%20%20%20%20%20%20%20options.add_argument('--disable-gpu')%0A%20%20%20%20%20%20%20%20options.add_argument('--no-sandbox')%0A%20%20%20%20%20%20%20%20options.add_argument('--disable-dev-shm-usage')%0A%20%20%20%20%20%20%20%20print('Opening%20Chrome%20Webdriver')%0A%20%20%20%20%20%20%20%20return%20webdriver.Chrome(service%3DChromeService(ChromeDriverManager().install())%2C%20options%3Doptions)%0A%0A%20%20%20%20def%20setup_edge()%3A%0A%20%20%20%20%20%20%20%20options%20%3D%20EdgeOptions()%0A%20%20%20%20%20%20%20%20options.add_argument('--headless')%0A%20%20%20%20%20%20%20%20options.add_argument('--disable-gpu')%0A%20%20%20%20%20%20%20%20options.add_argument('--no-sandbox')%0A%20%20%20%20%20%20%20%20options.add_argument('--disable-dev-shm-usage')%0A%20%20%20%20%20%20%20%20print('Opening%20Edge%20Webdriver')%0A%20%20%20%20%20%20%20%20return%20webdriver.Edge(service%3DEdgeService(EdgeChromiumDriverManager().install())%2C%20options%3Doptions)%0A%20%20%20%20driver%20%3D%20None%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20driver%20%3D%20setup_chrome()%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f'Chrome%20failed')%0A%20%20%20%20%20%20%20%20print('Falling%20back%20to%20Edge...')%0A%20%20%20%20%20%20%20%20driver%20%3D%20setup_edge()%0A%0A%20%20%20%20def%20get_page_content(url)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Opens%20a%20URL%20using%20Selenium%20and%20retrieves%20the%20page%20contents.%0A%20%20%20%20%20%20%20%20Tries%20Chrome%20first%2C%20falls%20back%20to%20Edge%20if%20Chrome%20fails.%0A%0A%20%20%20%20%20%20%20%20Args%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20url%20(str)%3A%20The%20URL%20to%20open%0A%0A%20%20%20%20%20%20%20%20Returns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20tuple%3A%20(raw_html%2C%20parsed_text)%20where%20raw_html%20is%20the%20page%20source%20and%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parsed_text%20is%20the%20cleaned%20text%20content%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20print('Scrape')%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20driver.get(url)%0A%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(2)%0A%20%20%20%20%20%20%20%20%20%20%20%20page_content%20%3D%20driver.page_source%0A%20%20%20%20%20%20%20%20%20%20%20%20soup%20%3D%20BeautifulSoup_1(page_content%2C%20'html.parser')%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20script%20in%20soup(%5B'script'%2C%20'style'%5D)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20script.decompose()%0A%20%20%20%20%20%20%20%20%20%20%20%20code_blocks%20%3D%20soup.find_all(%5B'pre'%2C%20'code'%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20block%20in%20code_blocks%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20block.string%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.string%20%3D%20f'%60%60%60%7Bblock.string%7D%60%60%60'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20block.string%20%3D%20f'%60%60%60%7Bblock.get_text()%7D%60%60%60'%0A%20%20%20%20%20%20%20%20%20%20%20%20text%20%3D%20soup.get_text().replace('%60%60%60Copy'%2C%20'%60%60%60')%0A%20%20%20%20%20%20%20%20%20%20%20%20lines%20%3D%20(line.strip()%20for%20line%20in%20text.splitlines())%0A%20%20%20%20%20%20%20%20%20%20%20%20chunks%20%3D%20(phrase.strip()%20for%20line%20in%20lines%20for%20phrase%20in%20line.split('%20%20'))%0A%20%20%20%20%20%20%20%20%20%20%20%20text%20%3D%20'%5Cn'.join((chunk%20for%20chunk%20in%20chunks%20if%20chunk))%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(page_content%2C%20text)%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f'An%20error%20occurred%3A%20%7Bstr(e)%7D')%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20(None%2C%20None)%0A%20%20%20%20return%20driver%2C%20get_page_content%0A%0A%0A%40app.cell%0Adef%20_(get_page_content)%3A%0A%20%20%20%20URL_2%20%3D%20'https%3A%2F%2Fmsoe-maic.com%2Flibrary%3Fnav%3DResearch'%0A%20%20%20%20(html_2%2C%20_)%20%3D%20get_page_content(URL_2)%0A%20%20%20%20return%20(html_2%2C)%0A%0A%0A%40app.cell%0Adef%20_(BeautifulSoup_1%2C%20html_2)%3A%0A%20%20%20%20soup_1%20%3D%20BeautifulSoup_1(html_2%2C%20'html.parser')%0A%20%20%20%20agent_sim_div%20%3D%20soup_1.find('div'%2C%20%7B'id'%3A%20'agent-simulation-experts'%7D)%0A%20%20%20%20modal_header%20%3D%20agent_sim_div.find(class_%3D'modal-header')%0A%20%20%20%20print(modal_header.get_text().strip()%20if%20modal_header%20else%20'No%20modal-header%20found')%0A%20%20%20%20print(agent_sim_div)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%23ff5555%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20STOP%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20...%20or%20keep%20going%20if%20you%20want%20to%20work%20ahead.%0A%0A%20%20%20%20%20%20%20%20---%0A%0A%20%20%20%20%20%20%20%20**Using%20LLMs%20to%20summarize%20scraped%20data.**%0A%0A%20%20%20%20%20%20%20%20If%20you're%20scraping%20unstructured%20data%2C%20then%20LLMs%20are%20a%20must.%20Although%20there%20is%20structure%20in%20the%20HTML%20elements%2C%20it%20can%20often%20be%20easier%20to%20ask%20an%20LLM%20to%20structure%20the%20output%20for%20you.%0A%0A%20%20%20%20%20%20%20%20Let's%20structure%20the%20output%20of%20a%20page%20listing%20refurbished%20iPhones%20for%20sale.%0A%0A%20%20%20%20%20%20%20%20You%20will%20need%20Gemini%20API%20keys%20to%20run%20this%20example.%20%5BLink%20to%20Gemini%20API%5D(https%3A%2F%2Faistudio.google.com%2F)%0A%0A%20%20%20%20%20%20%20%20%3Cspan%20style%3D%22color%3A%2355ff55%3Bfont-weight%3Abold%3Bfont-size%3A1.5rem%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20GO%0A%20%20%20%20%20%20%20%20%3C%2Fspan%3E%0A%0A%20%20%20%20%20%20%20%20This%20example%20will%3A%0A%20%20%20%20%20%20%20%20-%20Use%20Selenium%20to%20scrape%20for%20refurbished%20iPhones.%0A%20%20%20%20%20%20%20%20-%20Use%20an%20LLM%20to%20summarize%20the%20results%20into%20a%20structured%20format.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20os%0A%20%20%20%20from%20pydantic_ai%20import%20Agent%0A%20%20%20%20from%20typing%20import%20List%0A%20%20%20%20from%20pydantic%20import%20BaseModel%2C%20Field%0A%20%20%20%20return%20Agent%2C%20BaseModel%2C%20Field%2C%20List%2C%20os%0A%0A%0A%40app.cell%0Adef%20_(os)%3A%0A%20%20%20%20URL_3%20%3D%20'https%3A%2F%2Fwww.apple.com%2Fshop%2Frefurbished%2Fiphone%2Fiphone-14-pro'%0A%20%20%20%20os.environ%5B'GEMINI_API_KEY'%5D%20%3D%20...%0A%20%20%20%20return%20(URL_3%2C)%0A%0A%0A%40app.cell%0Adef%20_(BaseModel%2C%20Field%2C%20List)%3A%0A%20%20%20%20%23%20This%20is%20where%20you%20can%20specify%20the%20output%20structure%0A%0A%20%20%20%20class%20ProductResult(BaseModel)%3A%20%20%0A%20%20%20%20%20%20%20%20model%3A%20str%20%3D%20Field(description%3D'The%20model%20of%20the%20product')%0A%20%20%20%20%20%20%20%20description%3A%20str%20%3D%20Field(description%3D'The%20description%20of%20the%20product')%0A%20%20%20%20%20%20%20%20cost%3A%20int%20%3D%20Field(description%3D%22The%20cost%20of%20the%20product%22)%0A%20%20%20%20%20%20%20%20isp%3A%20str%20%3D%20Field(description%3D%22The%20internet%20service%20provider%22)%0A%20%20%20%20%20%20%20%20color%3A%20str%20%3D%20Field(description%3D%22The%20color%20of%20the%20product%22)%0A%20%20%20%20%20%20%20%20refurbished%3A%20bool%20%3D%20Field(description%3D%22Whether%20the%20product%20is%20refurbished%22)%0A%0A%20%20%20%20%23%20We%20are%20storing%20a%20list%20of%20ProductResults%20in%20the%20final%20output%0A%20%20%20%20class%20RequestResults(BaseModel)%3A%0A%20%20%20%20%20%20%20%20products%3A%20List%5BProductResult%5D%20%3D%20Field(description%3D'The%20list%20of%20product%20results')%0A%20%20%20%20return%20(RequestResults%2C)%0A%0A%0A%40app.cell%0Adef%20_(Agent%2C%20RequestResults)%3A%0A%20%20%20%20%23%20%22Here's%20where%20the%20AI%20comes%20in%22%20-%20Andrej%20Karpathy%0A%20%20%20%20agent%20%3D%20Agent(%20%23%20Create%20an%20agent%20that%20will%20structure%20the%20output%0A%20%20%20%20%20%20%20%20'google-gla%3Agemini-1.5-flash'%2C%0A%20%20%20%20%20%20%20%20result_type%3DRequestResults%2C%0A%20%20%20%20%20%20%20%20system_prompt%3D'Be%20concise%2C%20reply%20with%20one%20sentence.'%2C%20%20%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Agent%20system%20prompt%20-%20tell%20it%20what%20to%20do%0A%20%20%20%20%40agent.system_prompt%20%20%0A%20%20%20%20async%20def%20add_customer_name(ctx)%20-%3E%20str%3A%0A%20%20%20%20%20%20%20%20return%20f%22Your%20goal%20is%20to%20extract%20product%20information%20from%20web%20scraped%20pages%20and%20format%20it%20to%20a%20structured%20response.%22%0A%20%20%20%20return%20(agent%2C)%0A%0A%0A%40app.cell%0Adef%20_(URL_3%2C%20get_page_content)%3A%0A%20%20%20%20(_%2C%20text)%20%3D%20get_page_content(URL_3)%0A%20%20%20%20return%20(text%2C)%0A%0A%0A%40app.cell%0Aasync%20def%20_(agent%2C%20text)%3A%0A%20%20%20%20result%20%3D%20await%20agent.run(text)%0A%20%20%20%20return%20(result%2C)%0A%0A%0A%40app.cell%0Adef%20_(result)%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20from%20IPython.display%20import%20display%0A%0A%20%20%20%20%23%20Structure%20the%20output%20into%20a%20DataFrame%20to%20see%20our%20results%0A%20%20%20%20item_dicts%20%3D%20%5Bitem.model_dump()%20for%20item%20in%20result.data.products%5D%0A%20%20%20%20df%20%3D%20pd.DataFrame(item_dicts)%0A%20%20%20%20display(df.head(20))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(driver)%3A%0A%20%20%20%20driver.quit()%20%23%20Always%20remember%20to%20close%20the%20webdriver%20when%20you're%20done%20with%20it%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
